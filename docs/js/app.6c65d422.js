(function(){"use strict";var e={1364:function(e,t,n){var i=n(3751),a=n(641);const s={id:"app"};function o(e,t,n,i,o,r){const l=(0,a.g2)("router-view");return(0,a.uX)(),(0,a.CE)("div",s,[(0,a.bF)(l)])}var r={name:"App"},l=n(6262);const c=(0,l.A)(r,[["render",o]]);var d=c,u=n(5220),m=n(33);const p={class:"dm-screen"},h={class:"fixed-header"},v={class:"header-buttons"},y={class:"dropdown"},k={class:"content"},E={class:"tabs"},g={key:0,class:"tab-content"},b={class:"dashboard-section"},P={class:"card-container"},C={class:"card"},f={class:"dashboard-section"},I={class:"card-container"},L={class:"card"},w={class:"card"},H={key:1,class:"tab-content"},D={class:"dashboard-section"},S={class:"combat-container"},x={class:"card combat-card"};function M(e,t,n,s,o,r){const l=(0,a.g2)("ThinkingMode"),c=(0,a.g2)("ImageUpload"),d=(0,a.g2)("PlayerStats"),u=(0,a.g2)("NPCTracker"),M=(0,a.g2)("InitiativeTracker");return(0,a.uX)(),(0,a.CE)("div",p,[(0,a.Lk)("div",h,[t[8]||(t[8]=(0,a.Lk)("h1",null,"DM Screen",-1)),(0,a.Lk)("div",v,[(0,a.bF)(l,{mode:"dm"}),(0,a.Lk)("div",y,[(0,a.Lk)("button",{class:"dropdown-toggle",onClick:t[0]||(t[0]=(0,i.D$)(((...e)=>r.toggleDropdown&&r.toggleDropdown(...e)),["stop"]))},t[7]||(t[7]=[(0,a.Lk)("span",null,"Menu",-1),(0,a.Lk)("span",{class:"dropdown-icon"},"▼",-1)])),(0,a.bo)((0,a.Lk)("div",{class:"dropdown-menu",onClick:t[4]||(t[4]=(0,i.D$)((()=>{}),["stop"]))},[(0,a.Lk)("a",{href:"#",onClick:t[1]||(t[1]=(0,i.D$)(((...e)=>r.openPlayerView&&r.openPlayerView(...e)),["prevent"]))},"Open Player View"),(0,a.Lk)("a",{href:"#",onClick:t[2]||(t[2]=(0,i.D$)(((...e)=>r.exportData&&r.exportData(...e)),["prevent"]))},"Export Data"),(0,a.Lk)("a",{href:"#",onClick:t[3]||(t[3]=(0,i.D$)(((...e)=>r.importData&&r.importData(...e)),["prevent"]))},"Import Data")],512),[[i.aG,o.dropdownOpen]])])])]),(0,a.Lk)("div",k,[(0,a.Lk)("div",E,[(0,a.Lk)("button",{onClick:t[5]||(t[5]=e=>r.switchTab("dashboard")),class:(0,m.C4)(["tab-button",{active:"dashboard"===o.activeTab}])},t[9]||(t[9]=[(0,a.Lk)("span",{class:"tab-icon"},"📊",-1),(0,a.eW)(" Dashboard ")]),2),(0,a.Lk)("button",{onClick:t[6]||(t[6]=e=>r.switchTab("combat")),class:(0,m.C4)(["tab-button",{active:"combat"===o.activeTab}])},t[10]||(t[10]=[(0,a.Lk)("span",{class:"tab-icon"},"⚔️",-1),(0,a.eW)(" Combat ")]),2)]),"dashboard"===o.activeTab?((0,a.uX)(),(0,a.CE)("div",g,[(0,a.Lk)("div",b,[t[11]||(t[11]=(0,a.Lk)("h2",{class:"section-title"},"Game Resources",-1)),(0,a.Lk)("div",P,[(0,a.Lk)("div",C,[(0,a.bF)(c,{onImageUploaded:e.setImageUrl,mode:"dm"},null,8,["onImageUploaded"])])])]),(0,a.Lk)("div",f,[t[12]||(t[12]=(0,a.Lk)("h2",{class:"section-title"},"Character Management",-1)),(0,a.Lk)("div",I,[(0,a.Lk)("div",L,[(0,a.bF)(d)]),(0,a.Lk)("div",w,[(0,a.bF)(u)])])])])):(0,a.Q3)("",!0),"combat"===o.activeTab?((0,a.uX)(),(0,a.CE)("div",H,[(0,a.Lk)("div",D,[t[13]||(t[13]=(0,a.Lk)("h2",{class:"section-title"},"Combat Management",-1)),(0,a.Lk)("div",S,[(0,a.Lk)("div",x,[(0,a.bF)(M,{mode:"dm"})])])])])):(0,a.Q3)("",!0)])])}n(8111),n(7588),n(4603),n(7566),n(8721);const X={class:"player-stats"},U={class:"player-header"},N={class:"header-actions"},T={key:0,class:"empty-state"},V={key:1,class:"player-table-container"},O={class:"player-table"},F=["onClick"],J={key:0},_={key:0},R=["onUpdate:modelValue"],A={key:0,class:"stat-value"},Q=["onUpdate:modelValue"],$={key:0,class:"stat-value"},K=["onUpdate:modelValue"],j={key:0,class:"stat-value"},W=["onUpdate:modelValue"],z={key:0,class:"stat-value hp-value"},q=["onUpdate:modelValue"],B={key:0,class:"stat-value"},G=["onUpdate:modelValue"],Y={key:0,class:"stat-value"},Z={key:1,class:"checkbox-wrapper"},ee=["id","onUpdate:modelValue"],te=["for"];function ne(e,t,n,s,o,r){return(0,a.uX)(),(0,a.CE)("div",X,[(0,a.Lk)("div",U,[t[10]||(t[10]=(0,a.Lk)("h3",null,"Player Characters",-1)),(0,a.Lk)("div",N,[(0,a.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>r.toggleMode&&r.toggleMode(...e)),class:"toggle-button"},(0,m.v_)(o.editMode?"View Mode":"Edit Mode"),1),o.editMode?((0,a.uX)(),(0,a.CE)("button",{key:0,onClick:t[1]||(t[1]=(...e)=>r.addPlayer&&r.addPlayer(...e)),class:"add-button"},t[9]||(t[9]=[(0,a.Lk)("span",{class:"button-icon"},"+",-1),(0,a.eW)(" Add Player ")]))):(0,a.Q3)("",!0)])]),0===o.players.length?((0,a.uX)(),(0,a.CE)("div",T,t[11]||(t[11]=[(0,a.Lk)("p",null,'No players added yet. Click "Edit Mode" and then "Add Player" to get started.',-1)]))):((0,a.uX)(),(0,a.CE)("div",V,[(0,a.Lk)("table",O,[(0,a.Lk)("thead",null,[(0,a.Lk)("tr",null,[t[12]||(t[12]=(0,a.Lk)("th",{class:"stat-label"},"Stat",-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.players,((e,t)=>((0,a.uX)(),(0,a.CE)("th",{key:"header-"+t,class:"player-column"},[(0,a.eW)((0,m.v_)(e.name||"Unnamed")+" ",1),o.editMode?((0,a.uX)(),(0,a.CE)("button",{key:0,onClick:e=>r.removePlayer(t),class:"remove-player-button",title:"Remove player"},"×",8,F)):(0,a.Q3)("",!0)])))),128))])]),(0,a.Lk)("tbody",null,[o.editMode?((0,a.uX)(),(0,a.CE)("tr",J,[t[13]||(t[13]=(0,a.Lk)("td",{class:"stat-label"},"Name",-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.players,((e,n)=>((0,a.uX)(),(0,a.CE)("td",{key:"name-"+n},[o.editMode?(0,a.bo)(((0,a.uX)(),(0,a.CE)("input",{key:1,type:"text","onUpdate:modelValue":t=>e.name=t,onChange:t[2]||(t[2]=(...e)=>r.savePlayers&&r.savePlayers(...e)),class:"text-input",placeholder:"Character name"},null,40,R)),[[i.Jo,e.name]]):((0,a.uX)(),(0,a.CE)("span",_,(0,m.v_)(e.name||"Unnamed"),1))])))),128))])):(0,a.Q3)("",!0),(0,a.Lk)("tr",null,[t[14]||(t[14]=(0,a.Lk)("td",{class:"stat-label"},"Perception",-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.players,((e,n)=>((0,a.uX)(),(0,a.CE)("td",{key:"perception-"+n},[o.editMode?(0,a.bo)(((0,a.uX)(),(0,a.CE)("input",{key:1,type:"number","onUpdate:modelValue":t=>e.passivePerception=t,onChange:t[3]||(t[3]=(...e)=>r.savePlayers&&r.savePlayers(...e)),class:"number-input"},null,40,Q)),[[i.Jo,e.passivePerception]]):((0,a.uX)(),(0,a.CE)("span",A,(0,m.v_)(e.passivePerception),1))])))),128))]),(0,a.Lk)("tr",null,[t[15]||(t[15]=(0,a.Lk)("td",{class:"stat-label"},"Investigation",-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.players,((e,n)=>((0,a.uX)(),(0,a.CE)("td",{key:"investigation-"+n},[o.editMode?(0,a.bo)(((0,a.uX)(),(0,a.CE)("input",{key:1,type:"number","onUpdate:modelValue":t=>e.passiveInvestigation=t,onChange:t[4]||(t[4]=(...e)=>r.savePlayers&&r.savePlayers(...e)),class:"number-input"},null,40,K)),[[i.Jo,e.passiveInvestigation]]):((0,a.uX)(),(0,a.CE)("span",$,(0,m.v_)(e.passiveInvestigation),1))])))),128))]),(0,a.Lk)("tr",null,[t[16]||(t[16]=(0,a.Lk)("td",{class:"stat-label"},"Insight",-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.players,((e,n)=>((0,a.uX)(),(0,a.CE)("td",{key:"insight-"+n},[o.editMode?(0,a.bo)(((0,a.uX)(),(0,a.CE)("input",{key:1,type:"number","onUpdate:modelValue":t=>e.passiveInsight=t,onChange:t[5]||(t[5]=(...e)=>r.savePlayers&&r.savePlayers(...e)),class:"number-input"},null,40,W)),[[i.Jo,e.passiveInsight]]):((0,a.uX)(),(0,a.CE)("span",j,(0,m.v_)(e.passiveInsight),1))])))),128))]),(0,a.Lk)("tr",null,[t[17]||(t[17]=(0,a.Lk)("td",{class:"stat-label"},"HP",-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.players,((e,n)=>((0,a.uX)(),(0,a.CE)("td",{key:"hp-"+n},[o.editMode?(0,a.bo)(((0,a.uX)(),(0,a.CE)("input",{key:1,type:"number","onUpdate:modelValue":t=>e.hp=t,onChange:t[6]||(t[6]=(...e)=>r.savePlayers&&r.savePlayers(...e)),class:"number-input"},null,40,q)),[[i.Jo,e.hp]]):((0,a.uX)(),(0,a.CE)("span",z,(0,m.v_)(e.hp),1))])))),128))]),(0,a.Lk)("tr",null,[t[18]||(t[18]=(0,a.Lk)("td",{class:"stat-label"},"Speed",-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.players,((e,n)=>((0,a.uX)(),(0,a.CE)("td",{key:"speed-"+n},[o.editMode?(0,a.bo)(((0,a.uX)(),(0,a.CE)("input",{key:1,type:"number","onUpdate:modelValue":t=>e.speed=t,onChange:t[7]||(t[7]=(...e)=>r.savePlayers&&r.savePlayers(...e)),class:"number-input"},null,40,G)),[[i.Jo,e.speed]]):((0,a.uX)(),(0,a.CE)("span",B,(0,m.v_)(e.speed)+" ft",1))])))),128))]),(0,a.Lk)("tr",null,[t[19]||(t[19]=(0,a.Lk)("td",{class:"stat-label"},"Darkvision",-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.players,((e,n)=>((0,a.uX)(),(0,a.CE)("td",{key:"darkvision-"+n},[o.editMode?((0,a.uX)(),(0,a.CE)("div",Z,[(0,a.bo)((0,a.Lk)("input",{type:"checkbox",id:"darkvision-"+n,"onUpdate:modelValue":t=>e.darkvision=t,onChange:t[8]||(t[8]=(...e)=>r.savePlayers&&r.savePlayers(...e)),class:"checkbox-input"},null,40,ee),[[i.lH,e.darkvision]]),(0,a.Lk)("label",{for:"darkvision-"+n},(0,m.v_)(e.darkvision?"Yes":"No"),9,te)])):((0,a.uX)(),(0,a.CE)("span",Y,[(0,a.Lk)("span",{class:(0,m.C4)({"has-darkvision":e.darkvision})},(0,m.v_)(e.darkvision?"Yes":"No"),3)]))])))),128))])])])]))])}n(4114);var ie={data(){return{players:[],editMode:!1}},methods:{toggleMode(){this.editMode=!this.editMode},addPlayer(){this.players.push({name:"",passivePerception:10,passiveInvestigation:10,passiveInsight:10,hp:10,speed:30,darkvision:!1}),this.savePlayers()},removePlayer(e){confirm("Are you sure you want to remove this player?")&&(this.players.splice(e,1),this.savePlayers())},savePlayers(){localStorage.setItem("players",JSON.stringify(this.players)),window.dispatchEvent(new StorageEvent("storage",{key:"players",newValue:JSON.stringify(this.players)}))}},mounted(){const e=localStorage.getItem("players");e&&(this.players=JSON.parse(e))}};const ae=(0,l.A)(ie,[["render",ne],["__scopeId","data-v-4039958d"]]);var se=ae;const oe={class:"npc-tracker"},re={class:"npc-header"},le={key:0,class:"modal"},ce={class:"modal-content"},de={class:"modal-header"},ue={class:"form-group"},me={class:"form-group"},pe={class:"form-actions"},he={class:"npc-list-container"},ve={key:0,class:"npc-list"},ye={class:"npc-details"},ke={class:"npc-summary"},Ee={class:"npc-content"},ge={class:"npc-description"},be={class:"npc-actions"},Pe=["onClick"],Ce=["onClick"],fe={key:1,class:"empty-state"};function Ie(e,t,n,s,o,r){return(0,a.uX)(),(0,a.CE)("div",oe,[(0,a.Lk)("div",re,[t[6]||(t[6]=(0,a.Lk)("h3",null,"NPCs",-1)),(0,a.Lk)("button",{onClick:t[0]||(t[0]=e=>o.showModal=!0),class:"add-npc-button"},"Add NPC")]),o.showModal?((0,a.uX)(),(0,a.CE)("div",le,[(0,a.Lk)("div",ce,[(0,a.Lk)("div",de,[(0,a.Lk)("h3",null,(0,m.v_)(null!==o.editingIndex?"Edit NPC":"Add New NPC"),1),(0,a.Lk)("span",{class:"close",onClick:t[1]||(t[1]=e=>o.showModal=!1)},"×")]),(0,a.Lk)("form",{onSubmit:t[5]||(t[5]=(0,i.D$)(((...e)=>r.addNPC&&r.addNPC(...e)),["prevent"])),class:"npc-form"},[(0,a.Lk)("div",ue,[t[7]||(t[7]=(0,a.Lk)("label",{for:"npcName"},"Name:",-1)),(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=e=>o.npcName=e),id:"npcName",required:"",class:"form-input"},null,512),[[i.Jo,o.npcName]])]),(0,a.Lk)("div",me,[t[8]||(t[8]=(0,a.Lk)("label",{for:"npcDescription"},"Description:",-1)),(0,a.bo)((0,a.Lk)("textarea",{"onUpdate:modelValue":t[3]||(t[3]=e=>o.npcDescription=e),id:"npcDescription",required:"",class:"form-textarea",rows:"5"},null,512),[[i.Jo,o.npcDescription]])]),(0,a.Lk)("div",pe,[(0,a.Lk)("button",{type:"button",onClick:t[4]||(t[4]=e=>o.showModal=!1),class:"cancel-button"},"Cancel"),t[9]||(t[9]=(0,a.Lk)("button",{type:"submit",class:"save-button"},"Save NPC",-1))])],32)])])):(0,a.Q3)("",!0),(0,a.Lk)("div",he,[o.npcs.length?((0,a.uX)(),(0,a.CE)("div",ve,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.npcs,((e,t)=>((0,a.uX)(),(0,a.CE)("div",{key:e.name,class:"npc-item"},[(0,a.Lk)("details",ye,[(0,a.Lk)("summary",ke,(0,m.v_)(e.name),1),(0,a.Lk)("div",Ee,[(0,a.Lk)("p",ge,(0,m.v_)(e.description),1),(0,a.Lk)("div",be,[(0,a.Lk)("button",{onClick:e=>r.editNPC(t),class:"edit-button"},"Edit",8,Pe),(0,a.Lk)("button",{onClick:e=>r.removeNPC(t),class:"delete-button"},"Delete",8,Ce)])])])])))),128))])):((0,a.uX)(),(0,a.CE)("div",fe,t[10]||(t[10]=[(0,a.Lk)("p",null,'No NPCs added yet. Click the "Add NPC" button to create one.',-1)])))])])}var Le={data(){return{npcName:"",npcDescription:"",npcs:JSON.parse(localStorage.getItem("npcs"))||[],showModal:!1,editingIndex:null}},methods:{addNPC(){this.npcName&&this.npcDescription&&(null!==this.editingIndex?(this.npcs[this.editingIndex]={name:this.npcName,description:this.npcDescription},this.editingIndex=null):this.npcs.push({name:this.npcName,description:this.npcDescription}),localStorage.setItem("npcs",JSON.stringify(this.npcs)),this.npcName="",this.npcDescription="",this.showModal=!1)},editNPC(e){this.npcName=this.npcs[e].name,this.npcDescription=this.npcs[e].description,this.editingIndex=e,this.showModal=!0},removeNPC(e){confirm("Are you sure you want to delete this NPC?")&&(this.npcs.splice(e,1),localStorage.setItem("npcs",JSON.stringify(this.npcs)))}}};const we=(0,l.A)(Le,[["render",Ie],["__scopeId","data-v-2aae6371"]]);var He=we;const De={class:"image-tracker"},Se={key:0,class:"image-header"},xe={class:"image-controls"},Me={class:"upload-button"},Xe=["src"];function Ue(e,t,n,i,s,o){return(0,a.uX)(),(0,a.CE)("div",De,["dm"===n.mode?((0,a.uX)(),(0,a.CE)("div",Se,[t[3]||(t[3]=(0,a.Lk)("h3",null,"Image Display",-1)),(0,a.Lk)("div",xe,[(0,a.Lk)("label",Me,[t[2]||(t[2]=(0,a.Lk)("span",null,"Upload Image",-1)),(0,a.Lk)("input",{type:"file",onChange:t[0]||(t[0]=(...e)=>o.onFileChange&&o.onFileChange(...e)),accept:"image/*",class:"file-input"},null,32)]),s.imageUrl?((0,a.uX)(),(0,a.CE)("button",{key:0,onClick:t[1]||(t[1]=(...e)=>o.removeImage&&o.removeImage(...e)),class:"remove-button"},"Remove")):(0,a.Q3)("",!0)])])):(0,a.Q3)("",!0),s.imageUrl?((0,a.uX)(),(0,a.CE)("img",{key:1,src:s.imageUrl,alt:"Uploaded Image",class:"display-image"},null,8,Xe)):(0,a.Q3)("",!0)])}var Ne={props:{mode:{type:String,required:!0}},data(){return{imageUrl:localStorage.getItem("uploadedImageUrl")||null}},methods:{onFileChange(e){const t=e.target.files[0];t&&(this.imageUrl=URL.createObjectURL(t),localStorage.setItem("uploadedImageUrl",this.imageUrl),this.$emit("image-uploaded",this.imageUrl))},removeImage(){this.imageUrl=null,localStorage.removeItem("uploadedImageUrl"),this.$emit("image-uploaded",null)},syncImageUrl(e){"uploadedImageUrl"===e.key&&(this.imageUrl=e.newValue)}},mounted(){window.addEventListener("storage",this.syncImageUrl)},beforeUnmount(){window.removeEventListener("storage",this.syncImageUrl)}};const Te=(0,l.A)(Ne,[["render",Ue],["__scopeId","data-v-27265cf2"]]);var Ve=Te;const Oe={key:1,class:"thinking-section"},Fe={class:"tip-title"};function Je(e,t,n,i,s,o){return(0,a.uX)(),(0,a.CE)(a.FK,null,["dm"===n.mode?((0,a.uX)(),(0,a.CE)("button",{key:0,onClick:t[0]||(t[0]=(...e)=>o.toggleThinkingMode&&o.toggleThinkingMode(...e)),class:(0,m.C4)(s.thinkingMode?"stop-thinking-button":"start-thinking-button")},(0,m.v_)(s.thinkingMode?"Stop Thinking Mode":"Start Thinking Mode"),3)):(0,a.Q3)("",!0),s.thinkingMode&&"player"===n.mode?((0,a.uX)(),(0,a.CE)("div",Oe,[(0,a.Lk)("h3",Fe,(0,m.v_)(s.currentTip),1),t[1]||(t[1]=(0,a.Lk)("p",{class:"thinking-status"},"DM Is Thinking...",-1))])):(0,a.Q3)("",!0)],64)}const _e=["Use your environment to your advantage in combat.","Don't forget to roleplay your character's flaws.","Keep track of your spell slots and abilities.","Work with your party to create synergies in combat.","Remember that not every problem needs to be solved with combat.","Use downtime to develop your character's backstory.","Communicate with your DM about your character's goals.","Keep a journal of your adventures to track important plot points.","Always be prepared for the unexpected."];var Re={props:["mode"],data(){return{thinkingMode:!1,tips:_e,currentTip:"",thinkingModeInterval:null}},methods:{toggleThinkingMode(){this.thinkingMode=!this.thinkingMode,localStorage.setItem("thinkingMode",this.thinkingMode),this.thinkingMode&&this.getRandomTip()},getRandomTip(){const e=Math.floor(Math.random()*this.tips.length);this.currentTip=this.tips[e]},checkThinkingMode(){this.thinkingMode="true"===localStorage.getItem("thinkingMode"),this.thinkingMode&&this.getRandomTip()}},mounted(){this.checkThinkingMode(),this.thinkingModeInterval=setInterval(this.checkThinkingMode,5e3)},beforeUnmount(){clearInterval(this.thinkingModeInterval)}};const Ae=(0,l.A)(Re,[["render",Je],["__scopeId","data-v-52f4ac06"]]);var Qe=Ae;const $e={class:"initiative-tracker"},Ke={key:0},je={class:"action-buttons"};function We(e,t,n,i,s,o){const r=(0,a.g2)("EncounterManager"),l=(0,a.g2)("InitiativeMode"),c=(0,a.g2)("CombatMode");return(0,a.uX)(),(0,a.CE)("div",$e,["off"===s.currentView&&"dm"===n.mode?((0,a.uX)(),(0,a.CE)("div",Ke,[t[3]||(t[3]=(0,a.Lk)("h3",null,"Initiative Tracker",-1)),(0,a.Lk)("div",je,[(0,a.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>o.rollInitiative&&o.rollInitiative(...e)),class:"roll-initiative-button"},"Roll Initiative"),s.showEncounterManager?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("button",{key:0,onClick:t[1]||(t[1]=(...e)=>o.manageEncounters&&o.manageEncounters(...e)),class:"manage-encounters-button"},"Manage Encounters")),s.showEncounterManager?((0,a.uX)(),(0,a.CE)("button",{key:1,onClick:t[2]||(t[2]=(...e)=>o.hideEncounterManager&&o.hideEncounterManager(...e)),class:"hide-button"},"Hide Encounters")):(0,a.Q3)("",!0)]),s.showEncounterManager?((0,a.uX)(),(0,a.Wv)(r,{key:0,"current-enemies":[],onLoadEncounter:o.loadEncounterAndRoll},null,8,["onLoadEncounter"])):(0,a.Q3)("",!0)])):(0,a.Q3)("",!0),"initiative"===s.currentView?((0,a.uX)(),(0,a.Wv)(l,{key:1,mode:n.mode,onStartCombat:o.startCombat,onCloseInitiative:o.endCombat,ref:"initiativeMode"},null,8,["mode","onStartCombat","onCloseInitiative"])):(0,a.Q3)("",!0),"combat"===s.currentView?((0,a.uX)(),(0,a.Wv)(c,{key:2,mode:n.mode,onEndCombat:o.endCombat},null,8,["mode","onEndCombat"])):(0,a.Q3)("",!0)])}const ze={class:"initiative-mode"},qe={key:0},Be={class:"initiative-sections"},Ge={class:"initiative-section"},Ye={class:"initiative-list"},Ze={class:"initiative-name"},et={class:"initiative-controls"},tt=["onUpdate:modelValue"],nt={key:0,class:"empty-message"},it={class:"initiative-section"},at={class:"add-enemy"},st={class:"initiative-list"},ot={class:"initiative-name"},rt={key:0,class:"enemy-count"},lt=["href"],ct={class:"initiative-controls"},dt=["onUpdate:modelValue"],ut=["onUpdate:modelValue"],mt=["onUpdate:modelValue"],pt={class:"hide-control"},ht=["onUpdate:modelValue"],vt=["onClick"],yt=["onClick"],kt={key:0,class:"empty-message"},Et={class:"action-buttons"},gt=["disabled"],bt={key:1},Pt={class:"initiative-order"},Ct={class:"order-list"},ft={class:"initiative-value"},It={class:"entity-name"};function Lt(e,t,n,s,o,r){const l=(0,a.g2)("EncounterManager");return(0,a.uX)(),(0,a.CE)("div",ze,["dm"===n.mode?((0,a.uX)(),(0,a.CE)("div",qe,[(0,a.Lk)("div",Be,[(0,a.Lk)("div",Ge,[t[13]||(t[13]=(0,a.Lk)("h3",null,"Players",-1)),(0,a.Lk)("div",Ye,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.players,((e,n)=>((0,a.uX)(),(0,a.CE)("div",{key:"player-"+n,class:"initiative-item"},[(0,a.Lk)("div",Ze,(0,m.v_)(e.name),1),(0,a.Lk)("div",et,[(0,a.bo)((0,a.Lk)("input",{type:"number","onUpdate:modelValue":t=>e.initiative=t,class:"initiative-input",placeholder:"Init",onInput:t[0]||(t[0]=(...e)=>r.saveInitiativeData&&r.saveInitiativeData(...e))},null,40,tt),[[i.Jo,e.initiative]])])])))),128)),0===o.players.length?((0,a.uX)(),(0,a.CE)("div",nt," No players found. Add players in the Player Stats component. ")):(0,a.Q3)("",!0)])]),(0,a.Lk)("div",it,[t[16]||(t[16]=(0,a.Lk)("h3",null,"Enemies",-1)),(0,a.Lk)("div",at,[(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>o.newEnemyName=e),placeholder:"Enemy name",class:"enemy-name-input"},null,512),[[i.Jo,o.newEnemyName]]),(0,a.bo)((0,a.Lk)("input",{type:"number","onUpdate:modelValue":t[2]||(t[2]=e=>o.newEnemyModifier=e),placeholder:"Init modifier",class:"enemy-modifier-input"},null,512),[[i.Jo,o.newEnemyModifier]]),(0,a.bo)((0,a.Lk)("input",{type:"number","onUpdate:modelValue":t[3]||(t[3]=e=>o.newEnemyCount=e),placeholder:"Count",class:"enemy-count-input",min:"1"},null,512),[[i.Jo,o.newEnemyCount]]),(0,a.bo)((0,a.Lk)("input",{type:"number","onUpdate:modelValue":t[4]||(t[4]=e=>o.newEnemyHP=e),placeholder:"HP",class:"enemy-hp-input",min:"1"},null,512),[[i.Jo,o.newEnemyHP]]),(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":t[5]||(t[5]=e=>o.newEnemyReference=e),placeholder:"Reference URL",class:"enemy-reference-input"},null,512),[[i.Jo,o.newEnemyReference]]),(0,a.Lk)("button",{onClick:t[6]||(t[6]=(...e)=>r.addEnemy&&r.addEnemy(...e)),class:"add-button"},"Add")]),(0,a.Lk)("div",st,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.enemies,((e,n)=>((0,a.uX)(),(0,a.CE)("div",{key:"enemy-"+n,class:"initiative-item"},[(0,a.Lk)("div",ot,[(0,a.eW)((0,m.v_)(e.name)+" ",1),e.count>1?((0,a.uX)(),(0,a.CE)("span",rt,"("+(0,m.v_)(e.count)+")",1)):(0,a.Q3)("",!0),e.referenceUrl?((0,a.uX)(),(0,a.CE)("a",{key:1,href:e.referenceUrl,target:"_blank",class:"reference-link",title:"Open reference sheet"},t[14]||(t[14]=[(0,a.Lk)("span",{class:"reference-icon"},"📋",-1)]),8,lt)):(0,a.Q3)("",!0)]),(0,a.Lk)("div",ct,[(0,a.bo)((0,a.Lk)("input",{type:"number","onUpdate:modelValue":t=>e.initiative=t,class:"initiative-input",placeholder:"Init"},null,8,dt),[[i.Jo,e.initiative]]),(0,a.bo)((0,a.Lk)("input",{type:"number","onUpdate:modelValue":t=>e.count=t,class:"count-input",min:"1",onInput:t[7]||(t[7]=(...e)=>r.saveInitiativeData&&r.saveInitiativeData(...e))},null,40,ut),[[i.Jo,e.count]]),(0,a.bo)((0,a.Lk)("input",{type:"number","onUpdate:modelValue":t=>e.maxHP=t,class:"enemy-hp-input",placeholder:"HP",onInput:t[8]||(t[8]=(...e)=>r.saveInitiativeData&&r.saveInitiativeData(...e))},null,40,mt),[[i.Jo,e.maxHP]]),(0,a.Lk)("div",pt,[(0,a.bo)((0,a.Lk)("input",{type:"checkbox","onUpdate:modelValue":t=>e.hiddenFromPlayers=t,onChange:t[9]||(t[9]=(...e)=>r.saveInitiativeData&&r.saveInitiativeData(...e))},null,40,ht),[[i.lH,e.hiddenFromPlayers]]),t[15]||(t[15]=(0,a.Lk)("label",null,"Hidden",-1))]),(0,a.Lk)("button",{onClick:t=>r.rollForEntity(e),class:"roll-button"},"Roll",8,vt),(0,a.Lk)("button",{onClick:e=>r.removeEnemy(n),class:"remove-button"},"×",8,yt)])])))),128)),0===o.enemies.length?((0,a.uX)(),(0,a.CE)("div",kt," No enemies added yet. ")):(0,a.Q3)("",!0)])])]),(0,a.Lk)("div",Et,[(0,a.Lk)("button",{onClick:t[10]||(t[10]=(...e)=>r.rollForAll&&r.rollForAll(...e)),class:"roll-all-button"},"Roll For Enemies"),(0,a.Lk)("button",{onClick:t[11]||(t[11]=(...e)=>r.startCombat&&r.startCombat(...e)),class:"start-combat-button",disabled:!r.canStartCombat}," Start Combat ",8,gt),(0,a.Lk)("button",{onClick:t[12]||(t[12]=(...e)=>r.closeInitiative&&r.closeInitiative(...e)),class:"close-button"}," Close ")]),(0,a.bF)(l,{"current-enemies":o.enemies,onLoadEncounter:r.loadEncounterEnemies},null,8,["current-enemies","onLoadEncounter"])])):(0,a.Q3)("",!0),"player"===n.mode?((0,a.uX)(),(0,a.CE)("div",bt,[(0,a.Lk)("div",Pt,[t[17]||(t[17]=(0,a.Lk)("h3",null,"Roll for Initiative",-1)),(0,a.Lk)("div",Ct,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.playerInitiatives,((e,t)=>((0,a.uX)(),(0,a.CE)("div",{key:"order-"+t,class:"order-item player-item"},[(0,a.Lk)("span",ft,(0,m.v_)(e.initiative),1),(0,a.Lk)("span",It,(0,m.v_)(e.name),1)])))),128))])])])):(0,a.Q3)("",!0)])}n(2489),n(116),n(1701);const wt={class:"encounter-manager"},Ht={class:"encounter-form"},Dt=["disabled"],St={class:"saved-encounters"},xt={key:0,class:"empty-message"},Mt={key:1,class:"encounter-list"},Xt={class:"encounter-details"},Ut={class:"encounter-name"},Nt={class:"encounter-info"},Tt={class:"encounter-actions"},Vt=["onClick"],Ot=["onClick"];function Ft(e,t,n,s,o,r){return(0,a.uX)(),(0,a.CE)("div",wt,[t[3]||(t[3]=(0,a.Lk)("h3",null,"Encounter Manager",-1)),(0,a.Lk)("div",Ht,[(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>o.newEncounterName=e),placeholder:"Encounter name",class:"encounter-name-input"},null,512),[[i.Jo,o.newEncounterName]]),(0,a.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>r.saveCurrentAsEncounter&&r.saveCurrentAsEncounter(...e)),class:"save-encounter-button",disabled:!r.canSaveEncounter}," Save Current as Encounter ",8,Dt)]),(0,a.Lk)("div",St,[t[2]||(t[2]=(0,a.Lk)("h4",null,"Saved Encounters",-1)),0===o.savedEncounters.length?((0,a.uX)(),(0,a.CE)("div",xt," No saved encounters. Create one by adding enemies and saving in the Roll Initiative section. ")):((0,a.uX)(),(0,a.CE)("div",Mt,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.savedEncounters,((e,t)=>((0,a.uX)(),(0,a.CE)("div",{key:"encounter-"+t,class:"encounter-item"},[(0,a.Lk)("div",Xt,[(0,a.Lk)("div",Ut,(0,m.v_)(e.name),1),(0,a.Lk)("div",Nt,(0,m.v_)(e.enemies.length)+" enemies ",1)]),(0,a.Lk)("div",Tt,[(0,a.Lk)("button",{onClick:e=>r.loadEncounter(t),class:"load-button"},"Load",8,Vt),(0,a.Lk)("button",{onClick:e=>r.deleteEncounter(t),class:"delete-button"},"×",8,Ot)])])))),128))]))])])}var Jt={props:{currentEnemies:{type:Array,default:()=>[]}},data(){return{newEncounterName:"",savedEncounters:[]}},computed:{canSaveEncounter(){return""!==this.newEncounterName.trim()&&this.currentEnemies.length>0}},methods:{saveCurrentAsEncounter(){if(!this.canSaveEncounter)return;const e={name:this.newEncounterName.trim(),enemies:JSON.parse(JSON.stringify(this.currentEnemies)),timestamp:Date.now()};this.savedEncounters.push(e),this.saveEncountersToStorage(),this.newEncounterName=""},loadEncounter(e){if(e>=0&&e<this.savedEncounters.length){const t=this.savedEncounters[e];this.$emit("load-encounter",t.enemies)}},deleteEncounter(e){e>=0&&e<this.savedEncounters.length&&(this.savedEncounters.splice(e,1),this.saveEncountersToStorage())},saveEncountersToStorage(){localStorage.setItem("savedEncounters",JSON.stringify(this.savedEncounters)),window.dispatchEvent(new StorageEvent("storage",{key:"savedEncounters",newValue:JSON.stringify(this.savedEncounters)}))},loadEncountersFromStorage(){const e=localStorage.getItem("savedEncounters");if(e)try{this.savedEncounters=JSON.parse(e)}catch(t){console.error("Error parsing saved encounters:",t),this.savedEncounters=[]}},syncEncounters(e){if("savedEncounters"===e.key)try{this.savedEncounters=JSON.parse(e.newValue||"[]")}catch(t){console.error("Error parsing saved encounters from storage event:",t)}}},mounted(){this.loadEncountersFromStorage(),window.addEventListener("storage",this.syncEncounters)},beforeUnmount(){window.removeEventListener("storage",this.syncEncounters)}};const _t=(0,l.A)(Jt,[["render",Ft],["__scopeId","data-v-d9d15efa"]]);var Rt=_t,At={components:{EncounterManager:Rt},props:["mode"],data(){return{players:[],enemies:[],newEnemyName:"",newEnemyModifier:null,newEnemyCount:null,newEnemyHP:null,newEnemyReference:"",initiativeData:{players:[],enemies:[]}}},computed:{sortedCombatants(){const e=[...this.players.map((e=>({...e,isPlayer:!0}))),...this.enemies.map((e=>({...e,isPlayer:!1})))].filter((e=>null!==e.initiative&&void 0!==e.initiative));return e.sort(((e,t)=>t.initiative-e.initiative))},playerInitiatives(){return this.players.filter((e=>null!==e.initiative&&void 0!==e.initiative)).sort(((e,t)=>t.initiative-e.initiative))},canStartCombat(){return this.sortedCombatants.length>0}},methods:{startCombat(){this.saveInitiativeData(),this.$emit("start-combat")},closeInitiative(){this.$emit("close-initiative")},saveInitiativeData(){const e={players:this.players,enemies:this.enemies,timestamp:Date.now()};localStorage.setItem("initiativeData",JSON.stringify(e)),window.dispatchEvent(new StorageEvent("storage",{key:"initiativeData",newValue:JSON.stringify(e)}))},loadPlayers(){const e=localStorage.getItem("players");if(e){const t=JSON.parse(e);this.players=t.map((e=>({...e,initiative:null,currentHP:e.hp,maxHP:e.hp,tempHP:0})))}},addEnemy(){this.newEnemyName.trim()&&(this.enemies.push({name:this.newEnemyName.trim(),initiativeModifier:this.newEnemyModifier||0,initiative:null,count:Math.max(1,parseInt(this.newEnemyCount)||1),maxHP:this.newEnemyHP||null,currentHP:this.newEnemyHP||null,tempHP:0,referenceUrl:this.newEnemyReference||""}),this.newEnemyName="",this.newEnemyModifier=null,this.newEnemyCount=null,this.newEnemyHP=null,this.newEnemyReference="",this.saveInitiativeData())},removeEnemy(e){this.enemies.splice(e,1),this.saveInitiativeData()},rollDice(e){return Math.floor(Math.random()*e)+1},rollForEntity(e){const t=this.rollDice(20),n=e.initiativeModifier||0;e.initiative=t+n,"dm"===this.mode&&this.saveInitiativeData()},rollForAll(){const e={};this.enemies.forEach((t=>{e[t.name]||(e[t.name]=[]),e[t.name].push(t)})),Object.values(e).forEach((e=>{if(e.length>0){const t=this.rollDice(20),n=e[0].initiativeModifier||0,i=t+n;e.forEach((e=>{e.initiative=i}))}})),"dm"===this.mode&&this.saveInitiativeData()},loadEncounterEnemies(e){this.enemies=[],e.forEach((e=>{this.enemies.push({...e,initiative:null})})),this.saveInitiativeData()},loadInitiativeData(){const e=localStorage.getItem("initiativeData");if(e)try{const t=JSON.parse(e);t.players&&("dm"===this.mode?this.players.forEach((e=>{const n=t.players.find((t=>t.name===e.name));n&&void 0!==n.initiative&&(e.initiative=n.initiative)})):this.players=t.players),t.enemies&&(this.enemies=t.enemies)}catch(t){console.error("Error parsing initiative data:",t)}},syncInitiativeData(e){"initiativeData"===e.key&&this.loadInitiativeData()}},mounted(){"dm"===this.mode&&this.loadPlayers(),this.loadInitiativeData(),window.addEventListener("storage",this.syncInitiativeData)},beforeUnmount(){window.removeEventListener("storage",this.syncInitiativeData)}};const Qt=(0,l.A)(At,[["render",Lt],["__scopeId","data-v-ef00aa1c"]]);var $t=Qt;const Kt={class:"combat-mode"},jt={key:0,class:"combat-container"},Wt={class:"combat-header"},zt={class:"combat-title"},qt={class:"round-counter"},Bt={class:"combat-controls"},Gt={class:"initiative-order"},Yt={class:"order-list"},Zt={key:0,class:"hidden-toggle"},en=["id","onUpdate:modelValue","onChange"],tn={key:2,class:"enemy-group"},nn={key:1,class:"combat-container"},an={class:"combat-header"},sn={class:"combat-title"},on={class:"round-counter"},rn={class:"initiative-order"},ln={class:"order-list"},cn={key:0,class:"entity-name"},dn={key:1,class:"entity-name"};function un(e,t,n,s,o,r){const l=(0,a.g2)("CombatRow");return(0,a.uX)(),(0,a.CE)("div",Kt,["dm"===n.mode?((0,a.uX)(),(0,a.CE)("div",jt,[(0,a.Lk)("div",Wt,[(0,a.Lk)("div",zt,[t[2]||(t[2]=(0,a.Lk)("h3",null,"Combat Mode",-1)),(0,a.Lk)("div",qt,"Round: "+(0,m.v_)(o.currentRound),1)]),(0,a.Lk)("div",Bt,[(0,a.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>r.nextTurn&&r.nextTurn(...e)),class:"next-turn-button"},"Next Turn"),(0,a.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>r.endCombat&&r.endCombat(...e)),class:"end-combat-button"},"End Combat")])]),(0,a.Lk)("div",Gt,[t[4]||(t[4]=(0,a.Lk)("h4",null,"Initiative Order",-1)),(0,a.Lk)("div",Yt,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.groupedInitiative,((e,n)=>((0,a.uX)(),(0,a.CE)(a.FK,{key:"initiative-"+n},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.entities,((e,s)=>((0,a.uX)(),(0,a.CE)("div",{key:"entity-"+n+"-"+s,class:(0,m.C4)(["order-item",e.isPlayer?"player-item":"enemy-item",r.isCurrentTurn(e,n,s)?"current-turn":""])},[e.isPlayer?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("div",Zt,[t[3]||(t[3]=(0,a.Lk)("label",{for:"hidden-toggle-{{ groupIndex }}-{{ entityIndex }}",class:"hidden-toggle"},"Hide from players",-1)),(0,a.bo)((0,a.Lk)("input",{type:"checkbox",id:"hidden-toggle-"+n+"-"+s,"onUpdate:modelValue":t=>e.hiddenFromPlayers=t,onChange:t=>r.toggleEntityVisibility(e,n,s)},null,40,en),[[i.lH,e.hiddenFromPlayers]])])),e.isPlayer||e.count<=1?((0,a.uX)(),(0,a.Wv)(l,{key:1,entity:e,"onUpdate:entity":e=>r.updateEntity(e,n,s),onInitializeIndividualEnemies:r.initializeIndividualEnemies,onSaveHpData:r.saveHPData},null,8,["entity","onUpdate:entity","onInitializeIndividualEnemies","onSaveHpData"])):((0,a.uX)(),(0,a.CE)("div",tn,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.count,(t=>((0,a.uX)(),(0,a.Wv)(l,{key:"enemy-"+s+"-"+t,entity:r.getIndividualEnemy(e,t-1),"onUpdate:entity":n=>r.updateIndividualEnemyHP(e,t-1,n),onSaveHpData:r.saveHPData},null,8,["entity","onUpdate:entity","onSaveHpData"])))),128))]))],2)))),128))],64)))),128))])])])):(0,a.Q3)("",!0),"player"===n.mode?((0,a.uX)(),(0,a.CE)("div",nn,[(0,a.Lk)("div",an,[(0,a.Lk)("div",sn,[t[5]||(t[5]=(0,a.Lk)("h3",null,"Combat",-1)),(0,a.Lk)("div",on,"Round: "+(0,m.v_)(o.currentRound),1)])]),(0,a.Lk)("div",rn,[t[6]||(t[6]=(0,a.Lk)("h4",null,"Initiative Order",-1)),(0,a.Lk)("div",ln,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.groupedInitiativeForPlayers,((e,t)=>((0,a.uX)(),(0,a.CE)(a.FK,{key:"player-initiative-"+t},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.entities,((e,n)=>((0,a.uX)(),(0,a.CE)("div",{key:"player-entity-"+t+"-"+n,class:(0,m.C4)(["order-item",e.isPlayer?"player-item":"enemy-item",r.isCurrentTurn(e,t,n)?"current-turn":""])},[e.isPlayer?((0,a.uX)(),(0,a.CE)("div",cn,(0,m.v_)(e.name),1)):((0,a.uX)(),(0,a.CE)("div",dn," Enemy "))],2)))),128))],64)))),128))])])])):(0,a.Q3)("",!0)])}const mn={class:"entity-row"},pn=["href"],hn={class:"hp-tracking"},vn={class:"hp-inputs"},yn={class:"hp-bar-container"};function kn(e,t,n,s,o,r){return(0,a.uX)(),(0,a.CE)("div",mn,[(0,a.Lk)("div",{class:(0,m.C4)(["entity-name",{"entity-defeated":0===o.localEntity.currentHP}])},[(0,a.eW)((0,m.v_)(o.localEntity.name)+" ",1),o.localEntity.referenceUrl?((0,a.uX)(),(0,a.CE)("a",{key:0,href:o.localEntity.referenceUrl,target:"_blank",class:"reference-link",title:"Open reference sheet"},t[8]||(t[8]=[(0,a.Lk)("span",{class:"reference-icon"},"📋",-1)]),8,pn)):(0,a.Q3)("",!0)],2),(0,a.Lk)("div",hn,[(0,a.Lk)("div",vn,[(0,a.bo)((0,a.Lk)("input",{type:"number","onUpdate:modelValue":t[0]||(t[0]=e=>o.localEntity.currentHP=e),class:"hp-input current-hp",placeholder:"HP",onInput:t[1]||(t[1]=e=>r.updateHP())},null,544),[[i.Jo,o.localEntity.currentHP]]),t[9]||(t[9]=(0,a.Lk)("span",{class:"hp-separator"},"/",-1)),(0,a.bo)((0,a.Lk)("input",{type:"number","onUpdate:modelValue":t[2]||(t[2]=e=>o.localEntity.maxHP=e),class:"hp-input max-hp",placeholder:"Max",onInput:t[3]||(t[3]=e=>r.updateHP())},null,544),[[i.Jo,o.localEntity.maxHP]]),(0,a.bo)((0,a.Lk)("input",{type:"number","onUpdate:modelValue":t[4]||(t[4]=e=>o.localEntity.tempHP=e),class:"hp-input temp-hp",placeholder:"Temp",onInput:t[5]||(t[5]=e=>r.updateHP())},null,544),[[i.Jo,o.localEntity.tempHP]]),(0,a.Lk)("input",{type:"number",class:"hp-input hp-modify",placeholder:"±HP",onChange:t[6]||(t[6]=e=>r.handleHPChange(e.target.value)),onBlur:t[7]||(t[7]=e=>e.target.value="")},null,32)]),(0,a.Lk)("div",yn,[(0,a.Lk)("div",{class:"hp-bar",style:(0,m.Tr)({width:r.calculateHPPercentage()+"%",backgroundColor:r.getHPColor()})},null,4)])])])}var En={props:["entity"],data(){return{localEntity:{}}},created(){this.localEntity=JSON.parse(JSON.stringify(this.entity))},watch:{entity:{handler(e){this.localEntity=JSON.parse(JSON.stringify(e))},deep:!0}},methods:{updateHP(){this.localEntity.currentHP=null!==this.localEntity.currentHP?Number(this.localEntity.currentHP):null,this.localEntity.maxHP=null!==this.localEntity.maxHP?Number(this.localEntity.maxHP):null,this.localEntity.tempHP=null!==this.localEntity.tempHP?Number(this.localEntity.tempHP):0,null!==this.localEntity.currentHP&&null!==this.localEntity.maxHP&&this.localEntity.currentHP>this.localEntity.maxHP&&(this.localEntity.currentHP=this.localEntity.maxHP),null!==this.localEntity.currentHP&&this.localEntity.currentHP<0&&(this.localEntity.currentHP=0),null!==this.localEntity.maxHP&&this.localEntity.maxHP<0&&(this.localEntity.maxHP=0),this.localEntity.tempHP<0&&(this.localEntity.tempHP=0),!this.localEntity.isPlayer&&this.localEntity.count>1&&this.$emit("initialize-individual-enemies",this.localEntity),this.$emit("update:entity",this.localEntity),this.$emit("save-hp-data")},modifyHP(e){if(this.localEntity&&null!==this.localEntity.currentHP&&null!==this.localEntity.maxHP){if(e>0)this.localEntity.currentHP=Math.min(this.localEntity.maxHP,this.localEntity.currentHP+e);else if(e<0){const t=Math.abs(e);if(this.localEntity.tempHP>0)if(this.localEntity.tempHP>=t)this.localEntity.tempHP-=t;else{const e=t-this.localEntity.tempHP;this.localEntity.tempHP=0,this.localEntity.currentHP=Math.max(0,this.localEntity.currentHP-e)}else this.localEntity.currentHP=Math.max(0,this.localEntity.currentHP-t)}this.updateHP()}},handleHPChange(e){const t=parseInt(e);isNaN(t)||this.modifyHP(t)},getHPColor(){if(0===this.localEntity.currentHP)return"#f44336";if(!this.localEntity.currentHP||!this.localEntity.maxHP)return"#4caf50";const e=this.localEntity.currentHP/this.localEntity.maxHP*100;return e>50?"#4caf50":e>25?"#ff9800":"#f44336"},calculateHPPercentage(){if(!this.localEntity.currentHP||!this.localEntity.maxHP)return 100;const e=this.localEntity.currentHP/this.localEntity.maxHP*100;return Math.max(0,Math.min(100,e))}}};const gn=(0,l.A)(En,[["render",kn],["__scopeId","data-v-67d3ffa6"]]);var bn=gn,Pn={props:["mode"],components:{CombatRow:bn},data(){return{players:[],enemies:[],currentTurnIndex:0,currentRound:1,combatData:{currentTurnIndex:0,currentRound:1,timestamp:Date.now()},individualEnemies:{}}},computed:{sortedCombatants(){const e=[...this.players.map((e=>({...e,isPlayer:!0}))),...this.enemies.map((e=>({...e,isPlayer:!1})))].filter((e=>null!==e.initiative&&void 0!==e.initiative));return e.sort(((e,t)=>t.initiative-e.initiative))},groupedInitiative(){const e=this.sortedCombatants,t=[];let n=null;return e.forEach((e=>{n&&n.initiative===e.initiative?n.entities.push(e):(n={initiative:e.initiative,entities:[e]},t.push(n))})),t},playerInitiatives(){return this.players.filter((e=>null!==e.initiative&&void 0!==e.initiative)).sort(((e,t)=>t.initiative-e.initiative))},flattenedCombatants(){let e=[];return this.groupedInitiative.forEach((t=>{t.entities.forEach((n=>{e.push({...n,initiative:t.initiative})}))})),e},currentEntity(){return 0===this.flattenedCombatants.length?null:this.flattenedCombatants[this.currentTurnIndex]},groupedInitiativeForPlayers(){const e=[...this.players.map((e=>({...e,isPlayer:!0}))),...this.enemies.map((e=>({...e,name:"Enemy",isPlayer:!1})))].filter((e=>null!==e.initiative&&void 0!==e.initiative&&!e.hiddenFromPlayers)),t=e.sort(((e,t)=>t.initiative-e.initiative)),n=[];let i=null;return t.forEach((e=>{i&&i.initiative===e.initiative?i.entities.push(e):(i={initiative:e.initiative,entities:[e]},n.push(i))})),n}},methods:{isCurrentTurn(e,t,n){let i=0;for(let a=0;a<t;a++)i+=this.groupedInitiative[a].entities.length;return i+=n,i===this.currentTurnIndex},nextTurn(){this.currentTurnIndex++,this.currentEntity&&this.currentEntity.hiddenFromPlayers&&this.currentTurnIndex++,this.currentTurnIndex>=this.flattenedCombatants.length&&(this.currentTurnIndex=0,this.currentRound++),this.saveCombatData()},saveCombatData(){const e={currentTurnIndex:this.currentTurnIndex,currentRound:this.currentRound,timestamp:Date.now()};localStorage.setItem("combatData",JSON.stringify(e)),window.dispatchEvent(new StorageEvent("storage",{key:"combatData",newValue:JSON.stringify(e)})),this.saveHPData()},loadCombatData(){const e=localStorage.getItem("combatData");if(e)try{const t=JSON.parse(e);this.currentTurnIndex=t.currentTurnIndex||0,this.currentRound=t.currentRound||1}catch(t){console.error("Error parsing combat data:",t)}},syncCombatData(e){"combatData"===e.key&&this.loadCombatData()},initializeIndividualEnemies(e){this.individualEnemies[e.name]||(this.individualEnemies[e.name]=[]);while(this.individualEnemies[e.name].length<e.count){const t=this.individualEnemies[e.name].length+1;this.individualEnemies[e.name].push({name:`${e.name} ${t}`,currentHP:e.currentHP||e.maxHP,maxHP:e.maxHP||null,tempHP:e.tempHP||0,referenceUrl:e.referenceUrl||""})}this.individualEnemies[e.name].length>e.count&&(this.individualEnemies[e.name]=this.individualEnemies[e.name].slice(0,e.count))},getIndividualEnemy(e,t){return this.individualEnemies[e.name]||this.initializeIndividualEnemies(e),this.individualEnemies[e.name][t]&&!this.individualEnemies[e.name][t].name&&(this.individualEnemies[e.name][t].name=`${e.name} ${t+1}`),this.individualEnemies[e.name][t]||{name:`${e.name} ${t+1}`,currentHP:null,maxHP:null,tempHP:0,referenceUrl:e.referenceUrl||""}},updateIndividualEnemyHP(e,t,n){const i=this.getIndividualEnemy(e,t);n?(i.currentHP=n.currentHP,i.maxHP=n.maxHP,i.tempHP=n.tempHP||0):(i.currentHP=null!==i.currentHP?Number(i.currentHP):null,i.maxHP=null!==i.maxHP?Number(i.maxHP):null,i.tempHP=null!==i.tempHP?Number(i.tempHP):0),this.saveHPData()},saveHPData(){const e={players:this.players.map((e=>({name:e.name,currentHP:e.currentHP,maxHP:e.maxHP,tempHP:e.tempHP,hiddenFromPlayers:e.hiddenFromPlayers||!1}))),enemies:this.enemies.map((e=>({name:e.name,currentHP:e.currentHP,maxHP:e.maxHP,tempHP:e.tempHP,hiddenFromPlayers:e.hiddenFromPlayers||!1}))),individualEnemies:this.individualEnemies,timestamp:Date.now()};localStorage.setItem("combatHPData",JSON.stringify(e))},loadHPData(){const e=localStorage.getItem("combatHPData");if(e)try{const t=JSON.parse(e);t.players&&t.players.forEach((e=>{const t=this.players.find((t=>t.name===e.name));t&&(t.currentHP=e.currentHP,t.maxHP=e.maxHP,t.tempHP=e.tempHP||0,void 0!==e.hiddenFromPlayers&&(t.hiddenFromPlayers=e.hiddenFromPlayers))})),t.enemies&&t.enemies.forEach((e=>{const t=this.enemies.find((t=>t.name===e.name));t&&(t.currentHP=e.currentHP,t.maxHP=e.maxHP,t.tempHP=e.tempHP||0,void 0!==e.hiddenFromPlayers&&(t.hiddenFromPlayers=e.hiddenFromPlayers))})),t.individualEnemies&&(this.individualEnemies=t.individualEnemies)}catch(t){console.error("Error parsing HP data:",t)}},syncHPData(e){"combatHPData"===e.key&&this.loadHPData()},updateEntity(e,t,n){const i=this.groupedInitiative[t];if(i&&i.entities[n])if(i.entities[n]=e,e.isPlayer){const t=this.players.findIndex((t=>t.name===e.name));-1!==t&&(this.players[t]=e)}else{const t=this.enemies.findIndex((t=>t.name===e.name));-1!==t&&(this.enemies[t]=e)}},toggleEntityVisibility(e,t,n){this.updateEntity(e,t,n),this.saveCombatData(),this.saveInitiativeData()},endCombat(){localStorage.removeItem("combatData"),localStorage.removeItem("combatHPData"),this.$emit("end-combat")},loadInitiativeData(){const e=localStorage.getItem("initiativeData");if(e)try{const t=JSON.parse(e);t.players&&(this.players=t.players,this.players.forEach((e=>{void 0!==e.maxHP&&null!==e.maxHP||(e.maxHP=null),void 0!==e.currentHP&&null!==e.currentHP||(e.currentHP=e.maxHP),void 0===e.tempHP&&(e.tempHP=0),void 0===e.hiddenFromPlayers&&(e.hiddenFromPlayers=!1)}))),t.enemies&&(this.enemies=t.enemies,this.enemies.forEach((e=>{void 0!==e.maxHP&&null!==e.maxHP||(e.maxHP=null),void 0!==e.currentHP&&null!==e.currentHP||(e.currentHP=e.maxHP),void 0===e.tempHP&&(e.tempHP=0),void 0===e.hiddenFromPlayers&&(e.hiddenFromPlayers=!1),e.count>1&&this.initializeIndividualEnemies(e)})))}catch(t){console.error("Error parsing initiative data:",t)}this.loadHPData()},saveInitiativeData(){const e={players:this.players,enemies:this.enemies,timestamp:Date.now()};localStorage.setItem("initiativeData",JSON.stringify(e)),window.dispatchEvent(new StorageEvent("storage",{key:"initiativeData",newValue:JSON.stringify(e)}))},syncInitiativeData(e){"initiativeData"===e.key&&this.loadInitiativeData()}},mounted(){this.loadInitiativeData(),this.loadCombatData(),window.addEventListener("storage",this.syncInitiativeData),window.addEventListener("storage",this.syncCombatData),window.addEventListener("storage",this.syncHPData)},beforeUnmount(){window.removeEventListener("storage",this.syncInitiativeData),window.removeEventListener("storage",this.syncCombatData),window.removeEventListener("storage",this.syncHPData)}};const Cn=(0,l.A)(Pn,[["render",un],["__scopeId","data-v-b18926a2"]]);var fn=Cn,In={components:{InitiativeMode:$t,CombatMode:fn,EncounterManager:Rt},props:["mode"],data(){return{currentView:localStorage.getItem("initiativeTrackerView")||"off",showEncounterManager:!1,encounterToLoad:null}},methods:{rollInitiative(){this.currentView="initiative",this.updateInitiativeState()},manageEncounters(){this.showEncounterManager=!0},hideEncounterManager(){this.showEncounterManager=!1},loadEncounterAndRoll(e){this.encounterToLoad=e,this.rollInitiative()},startCombat(){this.currentView="combat",this.updateInitiativeState()},endCombat(){this.currentView="off",localStorage.removeItem("individualEnemies"),localStorage.removeItem("initiativeData"),this.updateInitiativeState()},updateInitiativeState(){localStorage.setItem("initiativeTrackerView",this.currentView),window.dispatchEvent(new StorageEvent("storage",{key:"initiativeTrackerView",newValue:this.currentView}))},syncInitiativeState(e){"initiativeTrackerView"===e.key&&(this.currentView=e.newValue)}},mounted(){window.addEventListener("storage",this.syncInitiativeState),this.$nextTick((()=>{if(this.encounterToLoad&&"initiative"===this.currentView){const e=this.$refs.initiativeMode;e&&(e.loadEncounterEnemies(this.encounterToLoad),this.encounterToLoad=null)}}))},beforeUnmount(){window.removeEventListener("storage",this.syncInitiativeState)}};const Ln=(0,l.A)(In,[["render",We],["__scopeId","data-v-2cf9009e"]]);var wn=Ln,Hn={components:{PlayerStats:se,NPCTracker:He,ImageUpload:Ve,ThinkingMode:Qe,InitiativeTracker:wn},data(){return{activeTab:"dashboard",dropdownOpen:!1}},methods:{openPlayerView(){window.open("/dm-screen/player-view","_blank"),this.dropdownOpen=!1},exportData(){const e={};for(let s=0;s<localStorage.length;s++){const t=localStorage.key(s);try{const n=localStorage.getItem(t);try{e[t]=JSON.parse(n)}catch(a){e[t]=n}}catch(a){console.error(`Error exporting key ${t}:`,a)}}const t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),n=URL.createObjectURL(t),i=document.createElement("a");i.href=n,i.download=`dm-screen-data-${(new Date).toISOString().slice(0,10)}.json`,document.body.appendChild(i),i.click(),setTimeout((()=>{document.body.removeChild(i),URL.revokeObjectURL(n)}),100),this.dropdownOpen=!1},importData(){const e=document.createElement("input");e.type="file",e.accept=".json",e.onchange=e=>{const t=e.target.files[0];if(!t)return;const n=new FileReader;n.onload=e=>{try{const t=JSON.parse(e.target.result);confirm("This will replace all your current data. Continue?")&&(Object.keys(t).forEach((e=>{const n=t[e];"object"===typeof n&&null!==n?localStorage.setItem(e,JSON.stringify(n)):localStorage.setItem(e,n)})),alert("Data imported successfully! The page will now reload to apply changes."),window.location.reload())}catch(e){alert("Error importing data. Please make sure the file is valid JSON."),console.error("Import error:",e)}},n.readAsText(t)},e.click(),this.dropdownOpen=!1},toggleDropdown(e){e&&e.stopPropagation(),this.dropdownOpen=!this.dropdownOpen},handleClickOutside(e){const t=this.$el.querySelector(".dropdown");t&&!t.contains(e.target)&&this.dropdownOpen&&(this.dropdownOpen=!1)},switchTab(e){this.activeTab=e,localStorage.setItem("dmScreenActiveTab",e)}},mounted(){const e=localStorage.getItem("dmScreenActiveTab");e&&(this.activeTab=e),document.addEventListener("click",this.handleClickOutside)},beforeUnmount(){document.removeEventListener("click",this.handleClickOutside)}};const Dn=(0,l.A)(Hn,[["render",M],["__scopeId","data-v-4595e147"]]);var Sn=Dn;const xn={class:"player-view"};function Mn(e,t,n,i,s,o){const r=(0,a.g2)("ImageUpload"),l=(0,a.g2)("ThinkingMode"),c=(0,a.g2)("InitiativeTracker");return(0,a.uX)(),(0,a.CE)("div",xn,[(0,a.bF)(r,{mode:"player"}),(0,a.bF)(l,{mode:"player"}),(0,a.bF)(c,{mode:"player"})])}var Xn={components:{ImageUpload:Ve,ThinkingMode:Qe,InitiativeTracker:wn},data(){return{tips:_e}},mounted(){},beforeUnmount(){}};const Un=(0,l.A)(Xn,[["render",Mn],["__scopeId","data-v-5d9692b1"]]);var Nn=Un;const Tn=[{path:"/",name:"Home",component:Sn},{path:"/dm-screen/player-view",name:"PlayerView",component:Nn},{path:"/dm-screen",name:"DMScreen",component:Sn}],Vn=(0,u.aE)({history:(0,u.LA)(),routes:Tn});var On=Vn;const Fn=(0,i.Ef)(d);Fn.use(On),Fn.mount("#app")}},t={};function n(i){var a=t[i];if(void 0!==a)return a.exports;var s=t[i]={exports:{}};return e[i].call(s.exports,s,s.exports,n),s.exports}n.m=e,function(){var e=[];n.O=function(t,i,a,s){if(!i){var o=1/0;for(d=0;d<e.length;d++){i=e[d][0],a=e[d][1],s=e[d][2];for(var r=!0,l=0;l<i.length;l++)(!1&s||o>=s)&&Object.keys(n.O).every((function(e){return n.O[e](i[l])}))?i.splice(l--,1):(r=!1,s<o&&(o=s));if(r){e.splice(d--,1);var c=a();void 0!==c&&(t=c)}}return t}s=s||0;for(var d=e.length;d>0&&e[d-1][2]>s;d--)e[d]=e[d-1];e[d]=[i,a,s]}}(),function(){n.d=function(e,t){for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={524:0};n.O.j=function(t){return 0===e[t]};var t=function(t,i){var a,s,o=i[0],r=i[1],l=i[2],c=0;if(o.some((function(t){return 0!==e[t]}))){for(a in r)n.o(r,a)&&(n.m[a]=r[a]);if(l)var d=l(n)}for(t&&t(i);c<o.length;c++)s=o[c],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return n.O(d)},i=self["webpackChunkdm_screen"]=self["webpackChunkdm_screen"]||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))}();var i=n.O(void 0,[504],(function(){return n(1364)}));i=n.O(i)})();
//# sourceMappingURL=app.6c65d422.js.map